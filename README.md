# Kufareva Lab rxncon and Boolnet scripts
Various scripts for the rxncon/boolnet pipeline of the Kufareva lab.

## Installation

### Getting the repository
`git clone https://github.com/palmerito0/kboolnet.git`

### Check out the proper branch
Branches:
- `master`: Working version of the pipeline (currently a WIP)
- `devel`: Main development branch, code changes should go here so they can be reviewed before merging into `master`.

To check out a branch, run: `git checkout <branch>`

### Install dependencies

Dependencies: `BoolNet`, `ggplot2`, `dplyr`, `openxlsx`, `googledrive`, `optparse`, `tidyr`, `CellNOptR`, `plyr`

To install these dependencies, run: `install.packages("BoolNet", "ggplot2", "dplyr", "openxlsx", "googledrive", "optparse", "tidyr", "CellNOptR", "plyr")`


## Contributing
A small intro to git that should be enough to get you up and running with the repository.
[See this helpful guide for more info.](https://rogerdudler.github.io/git-guide/)
Make sure to comment well!

### Making changes
After you have checked out the `devel` branch, you can make any changes you wish.
To save these changes, you must stage them, commit them, and then push them to the remote repository.

First, type `git status` to see which changes have been made to the repo and what needs to be staged. To stage a change, run: `git add <filename(s)>`

Then, run `git commit -m "<message>"` to "commit" your changes to the repository.

Finally, run `git push origin <branch>` to upload your changes to the remote repository. Only committed changes are uploaded.

### Updating your local repo
Run `git pull` to update your local repostory with all remote changes.
Git should do the job of merging changes to the same file. If you run into conflicts, shoot me an email and I'll help you resolve it. 

## Usage

### VerifyModel.R

`VerifyModel.R` is a script to automatically perform a simple round of validation on a set of modules with a rxncon "master" list.

![Verification simulation flowchart](https://i.ibb.co/5KjFpwT/image.png)

#### Before running

You must set the following variables in the `Config` section of the script:

- `rootDir`: Root directory of the kboolnet repository
- `rxnconPath`: Directory where the `rxncon2boolnet.py` script is stored (likely `~/.local/bin`)

#### Running

Run `VerifyModel.R` by sourcing it directly (`./VerifyModel.R`) or with `Rscript` (`Rscript ./VerifyModel.R`).

Parameters can be set as command-line arguments (`VerifyModel.R --arg="value"`) or in a config file (`VerifyModel.R --config="/path/to/config.R"`, see below for config file format). Command-line arguments override parameters set in the config file.

##### Parameters

- `file`: Path of local master rxncon file (mutually exclusive with `--driveFile`)
- `driveFile`: Name or URL of master rxncon file on Google Drive (mutually exclusive with `--file`)
- `modules`: Comma-separated modules to be loaded from master rxncon file. Omit this argument or leave it blank to load all modules.
- `minQuality`: Minimum quality for a rxncon rule to be loaded, default: 0. Rules without a quality tag are always loaded (Is this a good default behavior, or should it be changed?)
- `out`: Folder to which output files will be written, default: `./`
- `ligands`: Comma-separated rxncon name(s) of ligand node(s) to be toggled in verification simulation.

##### Config file

Config files should be `.R` files following this general format:

```R
config <- list(
	arg1 = "value",
	arg2 = "value",
	arg3 = 23
	...
)
```

#### Output

`VerifyModel.R` will output the following files:

- `modules.xlsx`: A rxncon file containing only the modules loaded by `VerifyModel.R`.
- `modules.boolnet`, `modules_initial_vals.csv`, `modules_symbols.csv`: BoolNet files generated by `rxncon2boolnet.py`
- `1-3.pdf`: Graphs of the path to attractor for each round of simulation (without, with, and without ligand(s), respectively)
